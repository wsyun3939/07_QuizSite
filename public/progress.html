<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>é€²æ—ä¸€è¦§</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      background-color: #f7f7f7;
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
    }
    .controls {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 15px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    select, button {
      font-size: 16px;
      padding: 6px 12px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    .reset-all-btn {
      background-color: #dc3545;
      color: white;
      border: none;
      cursor: pointer;
    }
    .reset-all-btn:hover {
      background-color: #a71d2a;
    }
    .back-btn {
      background-color: #6c757d;
      color: white;
      border: none;
      cursor: pointer;
    }
    .back-btn:hover {
      background-color: #5a6268;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 10px;
      text-align: center;
    }
    th {
      background-color: #007bff;
      color: white;
    }
    .reset-btn {
      background-color: #dc3545;
      color: white;
      padding: 6px 12px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .reset-btn:hover {
      background-color: #a71d2a;
    }
  </style>
</head>
<body>
  <h1>ã‚¯ã‚¤ã‚ºé€²æ—ä¸€è¦§</h1>

  <div class="controls">
    <label for="genreFilter">ã‚¸ãƒ£ãƒ³ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼:</label>
    <select id="genreFilter">
      <option value="all">ã™ã¹ã¦</option>
    </select>
    <button class="reset-all-btn" id="resetAllBtn">ğŸ—‘ï¸ å…¨é€²æ—ã‚’ãƒªã‚»ãƒƒãƒˆ</button>
    <button class="back-btn" id="back-button">ğŸ  ãƒˆãƒƒãƒ—ã¸æˆ»ã‚‹</button>
  </div>

  <table id="progress-table">
    <thead>
      <tr>
        <th>ã‚¸ãƒ£ãƒ³ãƒ«</th>
        <th>å½¢å¼</th>
        <th>é›£æ˜“åº¦</th>
        <th>ç¾åœ¨ã®å•é¡Œç•ªå·</th>
        <th>ã‚¹ã‚³ã‚¢</th>
        <th>æ“ä½œ</th>
      </tr>
    </thead>
    <tbody id="table-body">
      <!-- JSã§ç”Ÿæˆ -->
    </tbody>
  </table>

  <script>
    const genres = [
      'animeandgame', 'sports', 'lifestyle',
      'entertainment', 'society', 'humanities', 'science'
    ];
    const genreNames = {
      animeandgame: 'ã‚¢ãƒ‹ãƒ¡andã‚²ãƒ¼ãƒ ',
      sports: 'ã‚¹ãƒãƒ¼ãƒ„',
      lifestyle: 'ãƒ©ã‚¤ãƒ•ã‚¹ã‚¿ã‚¤ãƒ«',
      entertainment: 'èŠ¸èƒ½',
      society: 'ç¤¾ä¼š',
      humanities: 'æ–‡ç³»å­¦å•',
      science: 'ç†ç³»å­¦å•'
    };
    const types = ['MCQ', 'GROUP'];
    const levels = [1, 2, 3, 4, 5];

    const tableBody = document.getElementById('table-body');
    const genreFilter = document.getElementById('genreFilter');

    // ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ã«ã‚¸ãƒ£ãƒ³ãƒ«ã‚’è¿½åŠ 
    genres.forEach(g => {
      const opt = document.createElement("option");
      opt.value = g;
      opt.textContent = genreNames[g] || g;
      genreFilter.appendChild(opt);
    });

    // ãƒ†ãƒ¼ãƒ–ãƒ«æ›´æ–°
    function updateTable() {
      tableBody.innerHTML = '';
      const selectedGenre = genreFilter.value;

      genres.forEach(genre => {
        types.forEach(type => {
          levels.forEach(level => {
            const keyBase = `progress_${genre}_${type}_${level}`;
            const index = localStorage.getItem(`${keyBase}_index`);
            const score = localStorage.getItem(`${keyBase}_score`);

            if ((index !== null || score !== null) && (selectedGenre === 'all' || selectedGenre === genre)) {
              const tr = document.createElement('tr');
              tr.innerHTML = `
                <td>${genreNames[genre] || genre}</td>
                <td>${type}</td>
                <td>${level}</td>
                <td>${index ?? '-'}</td>
                <td>${score ?? '-'}</td>
                <td>
                  <button class="reset-btn" onclick="resetProgress('${keyBase}')">ãƒªã‚»ãƒƒãƒˆ</button>
                </td>
              `;
              tableBody.appendChild(tr);
            }
          });
        });
      });
    }

    function resetProgress(keyBase) {
      if (confirm(`${keyBase} ã®é€²æ—ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`)) {
        localStorage.removeItem(`${keyBase}_index`);
        localStorage.removeItem(`${keyBase}_score`);
        updateTable();
      }
    }

    document.getElementById("resetAllBtn").addEventListener("click", () => {
      if (confirm("å…¨ã‚¸ãƒ£ãƒ³ãƒ«ãƒ»å…¨å½¢å¼ãƒ»å…¨ãƒ¬ãƒ™ãƒ«ã®é€²æ—ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ")) {
        genres.forEach(genre => {
          types.forEach(type => {
            levels.forEach(level => {
              const keyBase = `progress_${genre}_${type}_${level}`;
              localStorage.removeItem(`${keyBase}_index`);
              localStorage.removeItem(`${keyBase}_score`);
            });
          });
        });
        updateTable();
        alert("å…¨é€²æ—ã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚");
      }
    });

    genreFilter.addEventListener("change", updateTable);
    document.getElementById("back-button").addEventListener("click", () => {
      window.location.href = "index.html";
    });

    updateTable();
  </script>
</body>
</html>
